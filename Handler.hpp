#pragma once
#include <Windows.h>
#include <iostream>
#include <fstream>
#include <string>
#include <vector>
#include <WinUser.h>

uintptr_t rebase(uintptr_t address);

namespace addresses
{
	uintptr_t WalkSpeed = 0xCE1050 - 0x400000 + reinterpret_cast<uintptr_t>(GetModuleHandle(nullptr));

	uintptr_t data_model_ptr_1 = 0x124E350 - 0x400000 + reinterpret_cast<uintptr_t>(GetModuleHandle(nullptr));

	uintptr_t data_model_ptr_2 = 0x124F130 - 0x400000 + reinterpret_cast<uintptr_t>(GetModuleHandle(nullptr));

	uintptr_t cs = 0xAEEB60 - 0x400000 + reinterpret_cast<uintptr_t>(GetModuleHandleA(nullptr));

	uintptr_t replicatorAddress = 0x6D0640 - 0x400000 + reinterpret_cast<uintptr_t>(GetModuleHandleA(nullptr));
}

namespace types
{
	using walkspeedFunc = double* (__fastcall*)(uintptr_t HumanoidInstance, float Speed);
	auto WalkSpeedSet = reinterpret_cast<walkspeedFunc>(addresses::WalkSpeed);

	using getdataModelFn = uintptr_t * (__thiscall*)(DWORD, DWORD*);
	auto r_getdatamodel2 = reinterpret_cast<getdataModelFn>(addresses::data_model_ptr_1);

	using getdatamodel2Fn = DWORD(*)();
	auto r_gmd2 = reinterpret_cast<getdatamodel2Fn>(addresses::data_model_ptr_2);
	
	using crashServerTypeFunc = unsigned int(__thiscall*)(uintptr_t _self);
	auto crashServerFunc = reinterpret_cast<crashServerTypeFunc>(addresses::cs);

	using serverEquipToolFn = void* (__thiscall*)(int a1, int dword_instance);
	auto Replicator = reinterpret_cast<serverEquipToolFn>(addresses::replicatorAddress);

	using accountAgeReplicator = void* (__thiscall*)(int a1, int a2);
	auto account_age_sent = reinterpret_cast<accountAgeReplicator>(rebase(0x948360));

	using account_user_idReplicator = char (__thiscall*)(int a1, int a2, int a3);
	auto replicator_uid = reinterpret_cast<account_user_idReplicator>(rebase(0xF33330));

	uintptr_t fflag = 0x387EC24 - 0x400000 + *reinterpret_cast<const std::uintptr_t*>(GetModuleHandleA(nullptr));
}

namespace offsets
{
	uintptr_t hum_offset = 0x7C; /* this offset still works as of 6/18/2022 */
	uintptr_t local_player_offset = 320; /* still upto-date  */
	uintptr_t datamodel_ending_vftable = 12;
	uintptr_t player_offset = 312;
	uintptr_t crash_offset = 0x17C;
}